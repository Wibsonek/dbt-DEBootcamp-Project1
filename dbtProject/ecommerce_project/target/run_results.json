{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-23T10:02:38.440277Z", "invocation_id": "d327d8d4-61ff-4471-8f12-d4c9cdbde035", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:36.196551Z", "completed_at": "2025-04-23T10:02:36.211992Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:36.213095Z", "completed_at": "2025-04-23T10:02:36.688661Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4983060359954834, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.stg_ecommerce_customers", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"ecommerce_project\".\"main\".\"customers\"\n),\n\nrenamed AS (\n    SELECT \n        customer_id AS customer_internal_id,\n        customer_unique_id AS customer_uuid,\n        customer_zip_code_prefix AS customer_zip_prefix,\n        customer_city AS customer_city_name,\n        customer_state AS customer_state_code,\n        CASE \n            WHEN customer_state in ('PR', 'SC', 'RS') THEN 'South'\n            WHEN customer_state in ('SP', 'RJ', 'MG', 'ES') THEN 'Southeast'\n            WHEN customer_state in ('BA', 'SE', 'AL', 'PE', 'PB', 'RN', 'CE', 'PI', 'MA') THEN 'Northeast'\n            WHEN customer_state in ('DF', 'GO', 'MT', 'MS') THEN 'Central-West'\n            WHEN customer_state in ('AM', 'PA', 'RO', 'RR', 'AC', 'AP', 'TO') THEN 'North'\n            ELSE 'Undefined'\n        END AS customer_region_name\n    FROM source\n)\n\nSELECT * FROM renamed", "relation_name": "\"ecommerce_project\".\"main\".\"stg_ecommerce_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:36.709865Z", "completed_at": "2025-04-23T10:02:36.724106Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:36.725384Z", "completed_at": "2025-04-23T10:02:36.815400Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11183333396911621, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.stg_ecommerce_geolocation", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"ecommerce_project\".\"main\".\"geolocation\"\n)\nSELECT * FROM source", "relation_name": "\"ecommerce_project\".\"main\".\"stg_ecommerce_geolocation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:36.831447Z", "completed_at": "2025-04-23T10:02:36.844005Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:36.844919Z", "completed_at": "2025-04-23T10:02:36.952544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12729620933532715, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.stg_ecommerce_order_items", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"ecommerce_project\".\"main\".\"order_items\"\n),\n\nrenamed AS (\n    SELECT\n        order_id AS order_internal_id,\n        order_item_id AS order_item_number,\n        product_id AS product_internal_id,\n        seller_id AS seller_internal_id,\n        CAST(shipping_limit_date AS DATE) AS shipping_deadline,\n        price AS item_price,\n        freight_value AS shipping_cost\n    FROM source\n)\n\nSELECT * FROM renamed", "relation_name": "\"ecommerce_project\".\"main\".\"stg_ecommerce_order_items\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:36.973800Z", "completed_at": "2025-04-23T10:02:36.991729Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:36.993020Z", "completed_at": "2025-04-23T10:02:37.100460Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13513994216918945, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.stg_ecommerce_order_reviews", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"ecommerce_project\".\"main\".\"order_reviews\"\n),\n\nrenamed AS (\n    SELECT\n        review_id AS review_internal_id,\n        order_id AS order_internal_id,\n        review_score AS review_rating,\n        review_comment_title AS review_title,\n        review_comment_message AS review_message,\n        CAST(review_creation_date AS DATE) AS review_created_date,\n        CAST (review_answer_timestamp AS TIMESTAMP) AS review_answered_date\n    FROM source\n\n)\n\nSELECT * FROM renamed", "relation_name": "\"ecommerce_project\".\"main\".\"stg_ecommerce_order_reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:37.126869Z", "completed_at": "2025-04-23T10:02:37.149932Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:37.151163Z", "completed_at": "2025-04-23T10:02:37.245361Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12693548202514648, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.stg_ecommerce_orders", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"ecommerce_project\".\"main\".\"orders\"\n),\n\nrenamed AS (\n\n    SELECT\n        order_id AS order_internal_id,\n        customer_id AS customer_internal_id,\n        order_status,\n        CAST (order_purchase_timestamp AS TIMESTAMP) AS order_purchased_at,\n        CAST (order_approved_at AS TIMESTAMP),\n        CAST (order_delivered_carrier_date AS TIMESTAMP) AS order_shipped_at,\n        CAST (order_delivered_customer_date AS TIMESTAMP) AS order_delivered_at,\n        CAST (order_estimated_delivery_date AS TIMESTAMP) AS order_estimated_delivery_at\n\n    FROM source\n\n)\n\nSELECT * FROM renamed", "relation_name": "\"ecommerce_project\".\"main\".\"stg_ecommerce_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:37.263093Z", "completed_at": "2025-04-23T10:02:37.279295Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:37.280274Z", "completed_at": "2025-04-23T10:02:37.368835Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11164021492004395, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.stg_ecommerce_payments", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"ecommerce_project\".\"main\".\"payments\"\n),\n\nrenamed AS (\n    SELECT\n        order_id AS order_internal_id,\n        payment_sequential AS payment_sequence_number,\n        payment_type,\n        payment_installments AS installment_count,\n        TRY_CAST(payment_value AS FLOAT) AS payment_amount\n    FROM source\n)\n\nSELECT * FROM renamed", "relation_name": "\"ecommerce_project\".\"main\".\"stg_ecommerce_payments\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:37.380009Z", "completed_at": "2025-04-23T10:02:37.393432Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:37.394644Z", "completed_at": "2025-04-23T10:02:37.493854Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11832189559936523, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.stg_ecommerce_product_category_name_translation", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"ecommerce_project\".\"main\".\"product_category_name_translation\"\n),\n\nrenamed AS (\n    SELECT\n        product_category_name AS product_category_name_original,\n        product_category_name_english\n    FROM source\n)\n\nSELECT * FROM renamed", "relation_name": "\"ecommerce_project\".\"main\".\"stg_ecommerce_product_category_name_translation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:37.509344Z", "completed_at": "2025-04-23T10:02:37.521155Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:37.522249Z", "completed_at": "2025-04-23T10:02:37.617533Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11348772048950195, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.stg_ecommerce_products", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"ecommerce_project\".\"main\".\"products\"\n),\n\nrenamed AS (\n    SELECT \n        product_id AS product_internal_id,\n        product_category_name AS product_category,\n        product_name_lenght,\n        product_description_lenght,\n        product_photos_qty AS product_image_count,\n        product_weight_g AS product_weight_grams,\n        product_length_cm,\n        product_height_cm,\n        product_width_cm\n    FROM source\n)\n\nSELECT * FROM renamed", "relation_name": "\"ecommerce_project\".\"main\".\"stg_ecommerce_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:37.630181Z", "completed_at": "2025-04-23T10:02:37.640429Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:37.641504Z", "completed_at": "2025-04-23T10:02:37.732797Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10754585266113281, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.stg_ecommerce_sellers", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM \"ecommerce_project\".\"main\".\"sellers\"\n),\n\nrenamed AS (\n    SELECT\n        seller_id AS seller_internal_id,\n        seller_zip_code_prefix  AS seller_zip_prefix,\n        seller_city AS seller_city_name,\n        seller_state  AS seller_state_code,\n        CASE  -- to powinno leciec w intermediate po seed\n                WHEN seller_state in ('PR', 'SC', 'RS') THEN 'South'\n                WHEN seller_state in ('SP', 'RJ', 'MG', 'ES') THEN 'Southeast'\n                WHEN seller_state in ('BA', 'SE', 'AL', 'PE', 'PB', 'RN', 'CE', 'PI', 'MA') THEN 'Northeast'\n                WHEN seller_state in ('DF', 'GO', 'MT', 'MS') THEN 'Central-West'\n                WHEN seller_state in ('AM', 'PA', 'RO', 'RR', 'AC', 'AP', 'TO') THEN 'North'\n                ELSE 'Undefined'\n            END AS seller_region_name\n    FROM source\n)\n\n\nSELECT * FROM renamed", "relation_name": "\"ecommerce_project\".\"main\".\"stg_ecommerce_sellers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:37.749911Z", "completed_at": "2025-04-23T10:02:37.765840Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:37.767054Z", "completed_at": "2025-04-23T10:02:37.923029Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1792447566986084, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.int_customers_region_joined", "compiled": true, "compiled_code": "WITH customers AS (\n        SELECT * FROM \"ecommerce_project\".\"main\".\"stg_ecommerce_customers\"\n),\n\n    regions AS (\n        SELECT * FROM  \"ecommerce_project\".\"main\".\"Region_Mapping\"\n    ),\n\n    joined_data AS (\n        SELECT\n            customers.customer_internal_id AS customer_internal_id,\n            customers.customer_uuid AS customer_uuid,\n            customers.customer_zip_prefix AS customer_zip_prefix,\n            customers.customer_city_name AS customer_city_name,\n            customers.customer_state_code AS customer_state_code,\n            regions.region_name AS region_name\n\n        FROM customers\n        JOIN regions\n        ON customers.customer_state_code = regions.state_code\n    )\n\nSELECT * FROM joined_data", "relation_name": "\"ecommerce_project\".\"main\".\"int_customers_region_joined\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:37.934647Z", "completed_at": "2025-04-23T10:02:37.947122Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:37.948172Z", "completed_at": "2025-04-23T10:02:38.037550Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10762906074523926, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.int_order_data_joined", "compiled": true, "compiled_code": "WITH payments AS (\n        SELECT * FROM \"ecommerce_project\".\"main\".\"stg_ecommerce_payments\"\n),\n\n    orders AS (\n        SELECT * FROM \"ecommerce_project\".\"main\".\"stg_ecommerce_orders\"\n    ),\n\n    order_items AS (\n        SELECT * FROM \"ecommerce_project\".\"main\".\"stg_ecommerce_order_items\"\n    ),\n\n\n    joined_data AS (\n\n        SELECT \n            payments.order_internal_id AS order_internal_id,\n            payments.payment_type AS payment_type,\n            payments.payment_amount AS payment_amount,\n            orders.customer_internal_id AS customer_internal_id,\n            order_items.seller_internal_id AS seller_internal_id,\n            orders.order_status AS order_status,\n            orders.order_purchased_at AS order_purchased_at,\n            orders.order_delivered_at AS order_delivered_at,\n            order_items.product_internal_id AS product_internal_id,\n            order_items.order_item_number AS order_item_number,\n            order_items.item_price AS item_price,\n            order_items.shipping_cost AS shipping_cost\n\n        FROM payments\n        JOIN orders\n            ON payments.order_internal_id = orders.order_internal_id\n        JOIN order_items \n            ON payments.order_internal_id = order_items.order_internal_id\n\n    )\n\nSELECT * FROM joined_data", "relation_name": "\"ecommerce_project\".\"main\".\"int_order_data_joined\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:38.054181Z", "completed_at": "2025-04-23T10:02:38.071175Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:38.072358Z", "completed_at": "2025-04-23T10:02:38.161700Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11356616020202637, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.int_seller_region_joined", "compiled": true, "compiled_code": "WITH sellers AS (\n        SELECT * FROM \"ecommerce_project\".\"main\".\"stg_ecommerce_sellers\"\n),\n\n    regions AS (\n        SELECT * FROM  \"ecommerce_project\".\"main\".\"Region_Mapping\"\n    ),\n\n    joined_data AS (\n        SELECT\n            sellers.seller_internal_id AS seller_internal_id,\n            sellers.seller_zip_prefix AS seller_zip_prefix,\n            sellers.seller_city_name AS seller_city_name,\n            sellers.seller_state_code AS seller_state_code,\n            regions.region_name AS region_name\n\n        FROM sellers\n        JOIN regions\n        ON sellers.seller_state_code = regions.state_code\n    )\n\nSELECT * FROM joined_data", "relation_name": "\"ecommerce_project\".\"main\".\"int_seller_region_joined\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:38.179613Z", "completed_at": "2025-04-23T10:02:38.200354Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:38.201387Z", "completed_at": "2025-04-23T10:02:38.286661Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11345648765563965, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.mart_customer_data", "compiled": true, "compiled_code": "WITH customer_data AS (\n\n        SELECT * FROM \"ecommerce_project\".\"main\".\"int_customers_region_joined\"\n\n    ),\n\n    order_data AS (\n\n        SELECT * FROM \"ecommerce_project\".\"main\".\"int_order_data_joined\"\n\n    ),\n\n    customer_orders_joined AS (\n\n        SELECT \n            customer_data.customer_internal_id AS customer_internal_id,\n            customer_data.customer_zip_prefix AS customer_zip_prefix,\n            customer_data.customer_city_name AS customer_city_name,\n            customer_data.customer_state_code AS customer_state_code,\n            customer_data.region_name AS region_name,\n            order_data.order_internal_id AS order_internal_id,\n            order_data.order_status AS order_status,\n            order_data.order_purchased_at AS order_purchased_at,\n            order_data.order_delivered_at AS order_delivered_at,\n            order_data.product_internal_id AS product_internal_id,\n            order_data.order_item_number AS order_item_number,\n            order_data.item_price AS item_price,\n            order_data.shipping_cost AS shipping_cost,\n            order_data.payment_type AS payment_type,\n            order_data.payment_amount AS payment_amount\n\n\n        FROM customer_data\n        JOIN order_data \n        ON customer_data.customer_internal_id = order_data.customer_internal_id\n\n    )\n\nSELECT * FROM customer_orders_joined", "relation_name": "\"ecommerce_project\".\"main\".\"mart_customer_data\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-23T10:02:38.303795Z", "completed_at": "2025-04-23T10:02:38.319205Z"}, {"name": "execute", "started_at": "2025-04-23T10:02:38.320391Z", "completed_at": "2025-04-23T10:02:38.411036Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11344289779663086, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ecommerce_project.mart_seller_data", "compiled": true, "compiled_code": "WITH seller_data AS (\n\n        SELECT * FROM \"ecommerce_project\".\"main\".\"int_seller_region_joined\"\n\n    ),\n\n    order_data AS (\n\n        SELECT * FROM \"ecommerce_project\".\"main\".\"int_order_data_joined\"\n\n    ),\n\n\n    seller_orders_joined AS (\n\n        SELECT \n            seller_data.seller_internal_id AS seller_internal_id,\n            seller_data.seller_zip_prefix AS seller_zip_prefix,\n            seller_data.seller_city_name AS seller_city_name,\n            seller_data.seller_state_code AS seller_state_code,\n            seller_data.region_name AS region_name,\n            order_data.order_internal_id AS order_internal_id,\n            order_data.order_status AS order_status,\n            order_data.order_purchased_at AS order_purchased_at,\n            order_data.order_delivered_at AS order_delivered_at,\n            order_data.product_internal_id AS product_internal_id,\n            order_data.order_item_number AS order_item_number,\n            order_data.item_price AS item_price,\n            order_data.shipping_cost AS shipping_cost,\n            order_data.payment_type AS payment_type,\n            order_data.payment_amount AS payment_amount\n\n\n        FROM seller_data\n        JOIN order_data \n        ON seller_data.seller_internal_id = order_data.seller_internal_id\n\n    )\n\n\n    SELECT * FROM seller_orders_joined", "relation_name": "\"ecommerce_project\".\"main\".\"mart_seller_data\"", "batch_results": null}], "elapsed_time": 2.417673110961914, "args": {"introspect": true, "log_format_file": "debug", "macro_debugging": false, "print": true, "partial_parse_file_diff": true, "state_modified_compare_more_unrendered_values": false, "skip_nodes_if_on_run_start_fails": false, "log_level_file": "debug", "invocation_command": "dbt run --profiles-dir /mnt/c/Users/cvieb/.dbt", "log_file_max_bytes": 10485760, "exclude": [], "use_colors_file": true, "log_path": "/mnt/e/Nauka/DE_Bootcamp/Projects/DBT_project1_ecommerce/dbtProject/ecommerce_project/logs", "state_modified_compare_vars": false, "use_colors": true, "write_json": true, "quiet": false, "select": [], "cache_selected_only": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_resource_names_without_spaces": false, "strict_mode": false, "show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "source_freshness_run_project_hooks": false, "version_check": true, "require_explicit_package_overrides_for_builtin_materializations": true, "which": "run", "populate_cache": true, "require_nested_cumulative_type_params": false, "indirect_selection": "eager", "printer_width": 80, "empty": false, "project_dir": "/mnt/e/Nauka/DE_Bootcamp/Projects/DBT_project1_ecommerce/dbtProject/ecommerce_project", "profiles_dir": "/mnt/c/Users/cvieb/.dbt", "favor_state": false, "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "partial_parse": true, "log_format": "default", "log_level": "info", "vars": {}, "static_parser": true, "send_anonymous_usage_stats": true}}